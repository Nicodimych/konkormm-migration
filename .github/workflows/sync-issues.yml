name: Ð¡Ð¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ Issues Ð² QUESTIONS.md

on:
  issues:
    types: [opened]

permissions:
  contents: write
  issues: write
  pull-requests: write

jobs:
  sync-issue-to-questions:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ
        uses: actions/checkout@v4
        
      - name: ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ðµ Issue
        id: issue
        run: |
          echo "ISSUE_NUMBER=${{ github.event.issue.number }}" >> $GITHUB_OUTPUT
          echo "ISSUE_TITLE=${{ github.event.issue.title }}" >> $GITHUB_OUTPUT
          echo "ISSUE_BODY<<EOF" >> $GITHUB_OUTPUT
          echo "${{ github.event.issue.body }}" >> $GITHUB_OUTPUT
          echo "EOF" >> $GITHUB_OUTPUT
          echo "ISSUE_AUTHOR=${{ github.event.issue.user.login }}" >> $GITHUB_OUTPUT
          
      - name: Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð²Ð¾Ð¿Ñ€Ð¾Ñ Ð² QUESTIONS.md
        run: |
          QUESTION_NUMBER=$(grep -c "^### â“" QUESTIONS.md || echo 0)
          NEXT_NUMBER=$((QUESTION_NUMBER + 1))
          
          cat >> QUESTIONS.md << 'EOF'
          
          ---
          
          ### â“ ${{ steps.issue.outputs.ISSUE_NUMBER }}. ${{ github.event.issue.title }}
          
          **ÐÐ²Ñ‚Ð¾Ñ€:** @${{ steps.issue.outputs.ISSUE_AUTHOR }}  
          **Ð’Ð¾Ð¿Ñ€Ð¾Ñ:** 
          
          ${{ github.event.issue.body }}
          
          **Ð¡Ñ‚Ð°Ñ‚ÑƒÑ:** â³ ÐžÐ¶Ð¸Ð´Ð°Ð½Ð¸Ðµ Ð¾Ñ‚Ð²ÐµÑ‚Ð°  
          **Ð”ÐµÐ´Ð»Ð°Ð¹Ð½:** TBD  
          **GitHub Issue:** #${{ github.event.issue.number }}
          
          **ÐžÑ‚Ð²ÐµÑ‚:**
          _Ð—Ð´ÐµÑÑŒ Ð¿Ð¾ÑÐ²Ð¸Ñ‚ÑÑ Ð¾Ñ‚Ð²ÐµÑ‚ Ð¾Ñ‚ AI-ÐºÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ð½Ñ‚Ð° Ð¸ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹_
          
          EOF
          
      - name: Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Pull Request Ñ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð¼
        uses: peter-evans/create-pull-request@v6
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: "Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ Ð²Ð¾Ð¿Ñ€Ð¾Ñ #${{ github.event.issue.number }} Ð² QUESTIONS.md"
          branch: issue-${{ github.event.issue.number }}
          title: "Ð’Ð¾Ð¿Ñ€Ð¾Ñ #${{ github.event.issue.number }}: ${{ github.event.issue.title }}"
          body: |
            ## ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ° Ð¸Ð· Issue
            
            Ð­Ñ‚Ð¾Ñ‚ PR Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ ÑÐ¾Ð·Ð´Ð°Ð½ Ð´Ð»Ñ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ° Ð¸Ð· Issue #${{ github.event.issue.number }} Ð² Ñ„Ð°Ð¹Ð» `QUESTIONS.md`.
            
            **Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ:**
            1. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð²Ð¾Ð¿Ñ€Ð¾Ñ Ð² `QUESTIONS.md`
            2. Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð¾Ñ‚Ð²ÐµÑ‚ Ð² Ñ€Ð°Ð·Ð´ÐµÐ» "ÐžÑ‚Ð²ÐµÑ‚:"
            3. Approve Ð¸ Merge ÑÑ‚Ð¾Ñ‚ PR
            4. ÐžÑ‚Ð²ÐµÑ‚ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¿Ð¾ÑÐ²Ð¸Ñ‚ÑÑ Ð² Issue
            
            **ÐžÑ€Ð¸Ð³Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Issue:** #${{ github.event.issue.number }}
            **ÐÐ²Ñ‚Ð¾Ñ€:** @${{ github.event.issue.user.login }}
          labels: Ð²Ð¾Ð¿Ñ€Ð¾Ñ
          
      - name: Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹ Ð² Issue
        uses: actions/github-script@v7
        with:
          script: |
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'âœ… Ð’Ð°Ñˆ Ð²Ð¾Ð¿Ñ€Ð¾Ñ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ Ð² Ñ„Ð°Ð¹Ð» QUESTIONS.md Ð¸ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½ Ñ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¼ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð¾Ð¼.\n\nÐžÑ‚Ð²ÐµÑ‚ Ð¿Ð¾ÑÐ²Ð¸Ñ‚ÑÑ Ð² Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐµÐµ Ð²Ñ€ÐµÐ¼Ñ Ð¸ Ð±ÑƒÐ´ÐµÑ‚ Ð²Ð¸Ð´ÐµÐ½ ÐºÐ°Ðº Ð·Ð´ÐµÑÑŒ, Ñ‚Ð°Ðº Ð¸ Ð² Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¼ Ð¿Ð»Ð°Ð½Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°.\n\nðŸ“– ÐžÑ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ñ‚ÑŒ Ð¼Ð¾Ð¶Ð½Ð¾ Ð² Pull Request, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð±ÑƒÐ´ÐµÑ‚ ÑÐ¾Ð·Ð´Ð°Ð½ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸.'
            })

